<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Fail at CTF h1-212 - The Evil Job &#8211; Gwendal Le Coguic</title>
<meta name="description" content="Gwendal Le Coguic, web developer and security researcher">
<meta name="keywords" content="ctf">

<!-- Twitter Cards --><meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://10degres.net/assets/img/header-background.jpg">
<meta name="twitter:title" content="Fail at CTF h1-212 - The Evil Job">
<meta name="twitter:description" content="Gwendal Le Coguic, web developer and security researcher">
<meta name="twitter:creator" content="@gwendallecoguic">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Fail at CTF h1-212 - The Evil Job">
<meta property="og:description" content="Gwendal Le Coguic, web developer and security researcher">
<meta property="og:url" content="http://10degres.net/ctf-h1-212/">
<meta property="og:site_name" content="Gwendal Le Coguic">
<meta property="og:image" content="http://10degres.net/assets/img/header-background.jpg">


<meta name="google-site-verification" content="GnoFwHUV3XNgLy4D-7XjLQ0Dbw6fKBXZnBzMn-0GBX8">



<link rel="canonical" href="http://10degres.net/ctf-h1-212/">
<link href="http://10degres.net/feed.xml" type="application/atom+xml" rel="alternate" title="Gwendal Le Coguic Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://10degres.net/assets/css/main.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://10degres.net/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://10degres.net/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://10degres.net/favicon.png">



</head>

<body id="post" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="http://10degres.net/">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="http://10degres.net/assets/img/me.jpg" alt="Gwen photo" class="author-photo">
					<h4>Gwen</h4>
					<p>Web developer reconverted to security researcher, playing bug bounty sometimes :)</p>
				</li>
				<li><a href="http://10degres.net/about/"><span class="btn btn-inverse">Learn More</span></a></li>
				<li>
					<a href="mailto:g@10degres.net"><i class="fa fa-fw fa-envelope"></i> Email</a>
				</li>
				<li>
					<a href="https://twitter.com/gwendallecoguic" target="_blank"><i class="fa fa-fw fa-twitter"></i> Twitter</a>
				</li>
				
				
				<li>
					<a href="https://linkedin.com/in/gwendal-le-coguic-77106729" target="_blank"><i class="fa fa-fw fa-linkedin"></i> LinkedIn</a>
				</li>
				<li>
					<a href="https://github.com/gwen001" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a>
				</li>
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="http://10degres.net/posts/">All Posts</a></li>
				<li><a href="http://10degres.net/tags/">All Tags</a></li>
			</ul>
		</li>
		
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->



<div class="entry-header">
  
  <div class="entry-image">
    <img src="http://10degres.net/assets/img/header-background.jpg" alt="Fail at CTF h1-212 - The Evil Job">
  </div><!-- /.entry-image -->
</div><!-- /.entry-header -->


<div id="main" role="main">
  <article class="hentry">
    <header class="header-title">
      <div class="header-title-wrap">
        
          <h1 class="entry-title"><a href="http://10degres.net/ctf-h1-212/" rel="bookmark" title="Fail at CTF h1-212 - The Evil Job">Fail at CTF h1-212 - The Evil Job</a></h1>
        
        <h2><span class="entry-date date published"><time datetime="2017-11-20T00:00:00+00:00">November 20, 2017</time></span></h2>
        
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content">
      <p>Hackerone recently released a CTF created by <a href="https://twitter.com/jobertabma" class="flashlink" target="_blank">Jobert Abma</a>. Even if I didn‚Äôt complete the challenge, it was so exciting and I was so close from the solution that I wanted to share a writeup.
Here is the tweet that tiggered the war:</p>

<p><em>‚ÄúHackers, hack your way to NYC this December for h1-212! An engineer of http://acme.org launched a new server for a new admin panel. He is completely confident that the server can‚Äôt be hacked, so he hid a flag. Details: https://www.hackerone.com/blog/hack-your-way-to-nyc-this-december-for-h1-212 ‚Ä¶. #TogetherWeHitHarder‚Äù</em></p>

<p>And here is the full description:</p>

<p><em>‚ÄúAn engineer of acme.org launched a new server for a new admin panel at http://104.236.20.43/. He is completely confident that the server can‚Äôt be hacked. He added a tripwire that notifies him when the flag file is read. He also noticed that the default Apache page is still there, but according to him that‚Äôs intentional and doesn‚Äôt hurt anyone. Your goal? Read the flag!‚Äù</em>
<!--more--></p>

<p>Below the different steps that led me to The Holy Flag.</p>

<h2 id="step-1-first-things-first-find-an-attack-surface">Step 1, first things first: find an attack surface</h2>

<p>As usual when I approach a new target, I immediately fired up my Burp Suite and started a directory scan with several tools like Cansina, Dirb and Dirsearch, each time with a different wordlist: SVNDigger, Robots Disallowed and Raft ones. Below the urls discovered:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>http://104.236.20.43/index.html
http://104.236.20.43/icons/README
http://104.236.20.43/flag
</code></pre>
</div>

<p>At the end of the scan I tried to compare the discovered items with my local Apache using <code class="highlighter-rouge">diff</code> to check if any modification occured but they were all identical.
While <code class="highlighter-rouge">/index.html</code> is the default Apache index page, <code class="highlighter-rouge">/icons/README</code> the default Apache icons list and of course it would be too easy if this <code class="highlighter-rouge">/flag</code> file would be the good one‚Ä¶<br />
<a href="/images/ctf-h1-212-fake-flag.png" target="_blank"><img src="/images/ctf-h1-212-fake-flag.png" alt="ctf h1-212 fake flag" /></a></p>

<p>At the same time I ran a Nmap scan on all TCP ports and top 500 UDP. This result to only two open ports: 22 and 80.
I quickly tried a brute force against SSH with Patator but it failed.</p>

<p>I then decided to use Burp Suite to try another type of issue called <code class="highlighter-rouge">Virtual Host Enumeration</code>.
I jumped on this because I recently read an article about that and I also sent a similar report to a private program a week before. Since the brilliant engineer works for <code class="highlighter-rouge">acme.org</code>, I configured the attack for this domain.
And it found something interesting at <code class="highlighter-rouge">admin.acme.org</code>:</p>

<p><a href="/images/ctf-h1-212-host-attack.png" target="_blank"><img src="/images/ctf-h1-212-host-attack.png" alt="ctf h1-212 host attack" /></a></p>

<p><strong>Resources:</strong><br />
<a href="https://blog.securitybreached.org/2017/11/04/access-localhost-via-virtual-host-virtual-host-enumeration/" class="flashlink" target="_blank">Accessing Localhost via Vhost | VIRTUAL HOST ENUMERATION</a><br />
<a href="https://github.com/jobertabma/virtual-host-discovery" class="flashlink" target="_blank">Jobert tool: virtual host scanner</a><br />
<a href="https://github.com/gwen001/vhost-brute" class="flashlink" target="_blank">vhost-brute: a PHP tool I wrote right after the CTF</a></p>

<h2 id="step-2-bargain-with-the-server">Step 2, bargain with the server</h2>

<p>I was supposed to have access to an hidden admin now so what‚Äôs next ? Let‚Äôs check the response of the server:
<a href="/images/ctf-h1-212-host-found.png" target="_blank"><img src="/images/ctf-h1-212-host-found.png" alt="ctf h1-212 host found" /></a></p>

<p>Looks like we have a cookie to play with! Obviously the first thing you would try is to change the value from <code class="highlighter-rouge">admin=no</code> to <code class="highlighter-rouge">admin=yes</code>‚Ä¶
Here we go, and the new response is:<br />
<a href="/images/ctf-h1-212-admin-yes.png" target="_blank"><img src="/images/ctf-h1-212-admin-yes.png" alt="ctf h1-212 admin yes" /></a></p>

<p>The message is clear enough, the <code class="highlighter-rouge">GET</code> method is not allowed, so switching to <code class="highlighter-rouge">POST</code> would return:<br />
<a href="/images/ctf-h1-212-method-post.png" target="_blank"><img src="/images/ctf-h1-212-method-post.png" alt="ctf h1-212 method post" /></a></p>

<p>According to the official documentation, aka Wikipedia xD<br />
<em>‚Äú<strong>406 Not Acceptable</strong>:
The requested resource is capable of generating only content not acceptable according to the Accept headers sent in the request.‚Äù</em></p>

<p>Ok then‚Ä¶ Altering the header <code class="highlighter-rouge">Accept</code> will not change anything, however if I also change the <code class="highlighter-rouge">Content-Type</code> in the request‚Ä¶<br />
<a href="/images/ctf-h1-212-content-type-json.png" target="_blank"><img src="/images/ctf-h1-212-content-type-json.png" alt="ctf h1-212 content type json" /></a></p>

<p>Server says that I am supposed to provide a body now, let‚Äôs say parameters, in JSON format. Since I have no idea about the name of the parameters, I supplied an empty string:<br />
<a href="/images/ctf-h1-212-body-param.png" target="_blank"><img src="/images/ctf-h1-212-body-param.png" alt="ctf h1-212 body param" /></a></p>

<p>The server requires a <code class="highlighter-rouge">domain</code> so let‚Äôs feed him with that! I won‚Äôt show you all the errors returned by the server (<code class="highlighter-rouge">.com</code> required, <code class="highlighter-rouge">212</code> required etc‚Ä¶) but here is the final string I got:<br />
<a href="/images/ctf-h1-212-good-domain.png" target="_blank"><img src="/images/ctf-h1-212-good-domain.png" alt="ctf h1-212 good domain" /></a></p>

<p><strong>Resources:</strong><br />
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes" class="flashlink" target="_blank">List of HTTP status codes</a></p>

<h2 id="step-3-start-crying-12">Step 3, start crying 1/2</h2>

<p>At this point here is the request I had:<br />
<a href="/images/ctf-h1-212-read-php.png" target="_blank"><img src="/images/ctf-h1-212-read-php.png" alt="ctf h1-212 read php" /></a></p>

<p>I firstly tried SQLi by injecting single quote, double quotes, encoded values, using SQLmap blablabla, nothing.<br />
I then tried XSS by injecting single quote, double quotes, less-than symbol, encoded values again and still nothing.<br />
I tried Local File Inclusion with Jhaddix worlists, nothing.<br />
I also tried to inject extra parameters and extra headers as well, nothing.<br />
I had a hard time to find the next step, I stayed stuck here 1 full day, trying figure out what kind of attack would work.</p>

<p>After a night break, I read a comment from another hacker that had scripted the 2 requests to be able to run them automatically in a row. 
At this moment I understood that there was probably a link between the POST request and the result of <code class="highlighter-rouge">read.php</code>.
To be honest I would not had realize that by myself.
I simply thought that the previous step was done and jumped to the next one without even thinking there could be a relation‚Ä¶ errrrrr that was my first mistake.</p>

<p>So I did it too. I PHP curly scripted the requests, and from here I only used my script to find the flag, that was my second mistake, this is probably the reason why I didn‚Äôt get it.</p>

<p>So basically, altering the <code class="highlighter-rouge">domain</code> provided in the JSON param in the body of the POST request would lead to a different response when calling <code class="highlighter-rouge">read.php</code> with the corresponding <code class="highlighter-rouge">id</code> returned by the server.
After playing a little bit with the value, injecting stupid characters and so on, I finally was able to retrieve datas and I quickly realized that I was in front of a SSRF issue.<br />
<a href="/images/ctf-h1-212-ssrf-80.png" target="_blank"><img src="/images/ctf-h1-212-ssrf-80.png" alt="ctf h1-212 ssrf 80" /></a></p>

<p>The final response is the base64 encoded result of the HTTP request performed by the server. In this case: <code class="highlighter-rouge">http://localhost:80/index.html</code> the default Apache page.</p>

<p><strong>Important note:</strong> at each HTTP POST request performed by the server, <code class="highlighter-rouge">id</code> is incremented by 1. 
Sometimes it get back to 0 but I didn‚Äôt figure out why/when/how. It doesn‚Äôt seem to be shared between the hackers.</p>

<h2 id="step-3-or-4-or-5-port-scanning">Step 3‚Äô or 4 or 5, port scanning</h2>

<p>I‚Äôm pretty sure that this step was supposed to be the last one but when I‚Äôm able to trigger a SSRF issue, I always perform a port scan first.</p>

<p>I simply moved my 2 curl requests into a <code class="highlighter-rouge">for</code> loop that iterates from 1 to 65535, because why not ?
Ok, Jobert said that brute force is not the key but you know‚Ä¶ I‚Äôm still a kid in my mind, I‚Äôm a geek, I‚Äôm a hacker so‚Ä¶ 
when someone tell me to NOT do something, then I feel really bad if I don‚Äôt give it a single try!</p>

<p>After few minutes and some false positive, my script displayed a different response corresponding to the port <code class="highlighter-rouge">1337</code>:<br />
<a href="/images/ctf-h1-212-ssrf-1337.png" target="_blank"><img src="/images/ctf-h1-212-ssrf-1337.png" alt="ctf h1-212 ssrf 1337" /></a></p>

<p>Confirmed with Burp:
<a href="/images/ctf-h1-212-ssrf-1337-burp.png" target="_blank"><img src="/images/ctf-h1-212-ssrf-1337-burp.png" alt="ctf h1-212 ssrf 1337 burp" /></a></p>

<p>Easy peasy.<br />
I was pretty sure this was the key so I stopped my script at port 19187, enough spam.</p>

<p><strong>Resources:</strong><br />
<a href="https://www.hackerone.com/blog-How-To-Server-Side-Request-Forgery-SSRF" class="flashlink" target="_blank">Hackerone article about SSRF</a><br />
<a href="http://www.agarri.fr/docs/AppSecEU15-Server_side_browsing_considered_harmful.pdf" class="flashlink" target="_blank">Server-side browsing considered harmful by Nicolas Gr√©goire</a></p>

<h2 id="step-x-try-harder-cry-stronger-22">Step x, try harder, cry stronger 2/2</h2>

<p>Ok I have the good parameter, a good domain, good Content-Type, good cookie, the l33t port, I can decode base64, so far so good!
Now I simply need to request a single file like <code class="highlighter-rouge">/index.html</code> or <code class="highlighter-rouge">/flag</code>, that would be great!
Hopefully this is the final step. Unfortunately this is where things gone wrong :/</p>

<p>I read many documentation and articles about SSRF but the most useful was the SSRF bible and the presentation from Orange Tsai. Simply awesome.
The idea: <code class="highlighter-rouge">http://1.1.1.1 &amp;@2.2.2.2# @3.3.3.3/</code><br />
Since <code class="highlighter-rouge">&amp;</code>, <code class="highlighter-rouge">%</code> and <code class="highlighter-rouge">#</code> are forbidden characters in this challenge, from this two papers I understood that I should combine the SSRF with a CRLF.
Dealing with <code class="highlighter-rouge">\r</code> and <code class="highlighter-rouge">\n</code> I quickly got a strange behavior:<br />
<a href="/images/ctf-h1-212-ssrf-1337-400.png" target="_blank"><img src="/images/ctf-h1-212-ssrf-1337-400.png" alt="ctf h1-212 ssrf 1337 400" /></a></p>

<p>Yes, yes, yes, it‚Äôs not Apache anymore, I am now dealing with a Nginx install.
Does it matter ? Well I don‚Äôt know, maybe those servers don‚Äôt react to CRLF the same way‚Ä¶</p>

<p>Since the first part of the domain must contain <code class="highlighter-rouge">212</code> and the last part must end by <code class="highlighter-rouge">.com</code>, I had configure a dns <code class="highlighter-rouge">A</code> record of my own domain to point to <code class="highlighter-rouge">127.0.0.1</code>, that was useless but hey, how could I know!
Based on the ‚Äú3 parts payload‚Äù mentionned by Orange Tsai, here are some stuff I tried:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>poc212.10degres.net:1337/flag @www.google.com @h1-212.acme.com
poc212.10degres.net:1337/\r @www.google.com\r @h1-212.acme.com
poc212.10degres.net:1337\r\t@www.google.com\r\t@h1-212.acme.com
poc212.10degres.net:1337\s@www.google.com\s@h1-212.acme.com
poc212.10degres.net:1337\r\n@www.google.com\r\n@h1-212.acme.com
poc212.10degres.net:1337 @\r\nwww.google.com @\r\nh1-212.acme.com
poc212.10degres.net:1337 @/flag @h1-212.acme.com
poc212.10degres.net:1337 @www.google.com @/h1-212.acme.com
</code></pre>
</div>

<p>After some hours (‚Ä¶) I decided to use the SSRF against my own server, that way I could see what kind of requests the CTF server send.
Installing and configuring Nginx. Configuring a <code class="highlighter-rouge">.com</code> domain I have and the vhost that will be accepted by Jobert‚Äôs code as well.
Same same but different:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>poc212.10degres.net:1337/flag @www.google.com @h1-212.10degres.com
poc212.10degres.net:1337/\r @www.google.com\r @h1-212.10degres.com
poc212.10degres.net:1337\r\t@www.google.com\r\t@h1-212.10degres.com
poc212.10degres.net:1337\s@www.google.com\s@h1-212.10degres.com
poc212.10degres.net:1337\r\n@www.google.com\r\n@h1-212.10degres.com
poc212.10degres.net:1337 @\r\nwww.google.com @\r\nh1-212.10degres.com
poc212.10degres.net:1337 @/flag @h1-212.10degres.com
poc212.10degres.net:1337 @www.google.com @/h1-212.10degres.com
</code></pre>
</div>

<p>Checking the log, again and again and still got this f*****g error 400:
<a href="/images/ctf-h1-212-nginx-400.png" target="_blank"><img src="/images/ctf-h1-212-nginx-400.png" alt="ctf h1-212 nginx 400" /></a></p>

<p>Better use Netcat to see the headers received:<br />
<a href="/images/ctf-h1-212-netcat-400.png" target="_blank"><img src="/images/ctf-h1-212-netcat-400.png" alt="ctf h1-212 netcat 400" /></a></p>

<p>Well not so much information here‚Ä¶ Let‚Äôs try with tcdump then:
<a href="/images/ctf-h1-212-tcpdump.png" target="_blank"><img src="/images/ctf-h1-212-tcpdump.png" alt="ctf h1-212 tcpdump" /></a></p>

<p>Still nothing‚Ä¶ Let‚Äôs try something a bit more tricky. What about CRLF combined with header injection ?
My new payload looked like:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>poc212.10degres.net:1337/flag HTTP/1.0\rHost: admin.acme.org\rCookie: admin=yes\r @h1-212.10degres.com
</code></pre>
</div>

<p><a href="/images/ctf-h1-212-header-injection.png" target="_blank"><img src="/images/ctf-h1-212-header-injection.png" alt="ctf h1-212 header injection" /></a></p>

<p>Hey but what about encoding ? Yeah yeah yeah I tried that too, since <code class="highlighter-rouge">%</code> is not allowed, I had to try something else:
<code class="highlighter-rouge">\x0A</code> <code class="highlighter-rouge">0x0A</code> <code class="highlighter-rouge">\u000A</code> and the whole family, of course it didn‚Äôt work‚Ä¶</p>

<p>At the end of the day, the great <a href="https://twitter.com/EdOverflow" class="flashlink" target="_blank">@EdOverflow</a> gave me a hint, <em>kudos</em> to him.
He told me that I have gone too far with header injection, the solution was much simpler, I should focus on the first part of the payload.
That said, after a full day on this shit (and some violent outrage against Jobert ^^), I gave up for a good night.</p>

<p>Next day, let‚Äôs recap what I learned the day before:
the first part and the third part of the three part payload (found in Orange Tsai doc) are injectable and trigger the SSRF to a domain I can control and depending of the characters I use for the CRLF (<code class="highlighter-rouge">\t</code> <code class="highlighter-rouge">\s</code> <code class="highlighter-rouge">\r</code> <code class="highlighter-rouge">\s</code> <code class="highlighter-rouge">\b</code> <code class="highlighter-rouge">üí©</code>)  the server acts different, which seems to be logic‚Ä¶</p>

<p>Ok! New payloads on the way:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>0:1337/flag\r\nh1-212.10degres.com
</code></pre>
</div>

<p>No more luck, I continued to alter it with different characters, different encoding.
I also tried different protocols found in the SSRF bible: http, https, file, gopher, dict, mailto and so on‚Ä¶
With a good wordlist and a <code class="highlighter-rouge">for</code> loop it was easy to test them all but unfortunately no matter what I tried, my script always returned empty data.</p>

<p>One more day wasted for nothing, I didn‚Äôt move forward :/
I won‚Äôt show you all the payloads I tried, thousands and thousands, the only thing you need to know is that they all failed!
But the real question is: did they really failed?</p>

<p><strong>Resources:</strong><br />
<a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SSRF%20injection" class="flashlink" target="_blank">PayloadsAllTheThings resources on GitHub</a><br />
<a href="https://docs.google.com/document/d/1v1TkWZtrhzRLy0bYXBcdLUedXGb9njTNIJXa3u9akHM/edit" class="flashlink" target="_blank">SSRF bible</a><br />
<a href="http://blog.safebuff.com/2016/07/03/SSRF-Tips/" class="flashlink" target="_blank">SSRF tips by xl7dev</a><br />
<a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf" class="flashlink" target="_blank">A New Era of SSRF - Exploiting URL Parser in Trending Programming Languages! by Orange Tsai</a></p>

<h2 id="the-answer-free-your-mind">The answer, free your mind‚Ä¶</h2>

<p>After 5 full days working on the challenge, I finally spent the 2 last days with my childrens, trying to get over the headhash.
Since the challenge was ended, I decided to ask the answer to <a href="https://twitter.com/EdOverflow" class="flashlink" target="_blank">@EdOverflow</a>, knowing that I would probably cry‚Ä¶ and guess what? I did!</p>

<p>Remember that the <code class="highlighter-rouge">id</code> returned by the POST request is incremented by 1 for each request made by the server ?
But what if I inject a CRLF and the server does 2 requests ? Then the id returned will be incremented by 2, because 1+1=2!
Holy cow!!!!</p>

<p>Running my script like a moron, I only focused my mind on the result of <code class="highlighter-rouge">/read.php</code> and I didn‚Äôt even notice that the id jump the steps 2 by 2‚Ä¶<br />
<a href="/images/ctf-h1-212-moron.png" target="_blank"><img src="/images/ctf-h1-212-moron.png" alt="ctf h1-212 moron" /></a></p>

<p>So I need to decrease the id by 1 to get the result of the previous request.
Which is supposed to be the content of the file I requested aka <code class="highlighter-rouge">http://0:1337/flag</code>.
<a href="/images/ctf-h1-212-answer.png" target="_blank"><img src="/images/ctf-h1-212-answer.png" alt="ctf h1-212 answer" /></a></p>

<p>Et voil√† ! Decoded value:<br />
FLAG: CF,2dsV\/]fRAYQ.TDEp`w"M(%mU;p9+‚Ä¶‚Ä¶‚Ä¶</p>

<h2 id="conclusion">Conclusion</h2>

<p>Pay attention to all details, stupid idiot!</p>

<p>Jobert‚Äôs answer in 1 single line:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>D=104.236.20.43/;eval echo $(C=admin=yes;H='Host:http://admin.acme.org ';N=$(curl -H'Content-Type:application/json' -H$H -b$C -d'{"domain":"0:1337/flag\n212..com"}' "$D"|egrep -o '[0-9]+');curl -H$H -b$C "$D"read.php?id=`expr $N - 1`|jq .[])|base64 --decode
</code></pre>
</div>

<p>Winners:<br />
<a href="https://twitter.com/EdOverflow" class="flashlink" target="_blank">@EdOverflow</a><br />
<a href="https://twitter.com/albinowax" class="flashlink" target="_blank">@albinowax</a><br />
<a href="https://twitter.com/erbbysam" class="flashlink" target="_blank">@erbbysam</a></p>

<p>Congrats to these 3 people, congrats to all others that successfully got the flag and congrats to everyone that at least gave a try!</p>

      <footer class="entry-meta">
        <span class="entry-tags"><a href="http://10degres.net/tags/#ctf" title="Pages tagged ctf" class="tag"><span class="term">ctf</span></a></span>
        
        <div class="social-share">
  <ul class="socialcount socialcount-small inline-list">
    <li class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=http://10degres.net/ctf-h1-212/" title="Share on Facebook"><span class="count"><i class="fa fa-facebook-square"></i> Like</span></a></li>
    <li class="twitter"><a href="https://twitter.com/intent/tweet?text=http://10degres.net/ctf-h1-212/" title="Share on Twitter"><span class="count"><i class="fa fa-twitter-square"></i> Tweet</span></a></li>
    <li class="googleplus"><a href="https://plus.google.com/share?url=http://10degres.net/ctf-h1-212/" title="Share on Google Plus"><span class="count"><i class="fa fa-google-plus-square"></i> +1</span></a></li>
  </ul>
</div><!-- /.social-share -->
      </footer>
    </div><!-- /.entry-content -->
    
    <div class="see-also">
	<div class="see-also-header">
		<a href="javascript:;" class="see-also-btn">See Also</a>
	</div><!-- /.see-also-header -->
	<article>
		<ul>
			
				
					<li class="entry-title"><a href="https://www.hackerone.com/blog/hack-your-way-to-nyc-this-december-for-h1-212" target="_blank">Hack your way to NYC this December for h1-212</a></li>
				
			
				
					<li class="entry-title"><a href="https://github.com/Hacker0x01/h1-212-ctf-solutions" target="_blank">h1-212 writeups</a></li>
				
			
		</ul>
	</article>
</div><!-- /.see-also -->

    

<div class="read-more">
  
    <div class="read-more-header">
      <a href="javascript:;" class="read-more-btn">Read More</a>
    </div><!-- /.read-more-header -->
    <div class="read-more-content">
      <h3><a href="http://10degres.net/subdomain-enumeration/" title="Subdomain enumeration">Subdomain enumeration</a></h3>
      <p>A friend recently asked me what methods I use to find subdomains.To be honest I was confused, like *"oooohhh so much, brute force mmm... ...&hellip; <a href="http://10degres.net/subdomain-enumeration/">Continue reading</a></p>
    </div><!-- /.read-more-content -->
  
  <div class="read-more-list">
	  <div class="list-item">
		  
			<h4><a href="/massive-pwnage/">&laquo; Massive pwnage</a></h4>
			<span>Published on February 03, 2018</span>
		  
	  </div><!-- /.list-item -->
	  <div class="list-item">
		
			<h4><a href="/wordpress-testing/">Wordpress testing &raquo; </a></h4>
			<span>Published on September 12, 2017</span>
		
	  </div><!-- /.list-item -->
  </div><!-- /.read-more-list -->
</div><!-- /.read-more -->

  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2018 Gwendal Le Coguic</span>

  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://10degres.net/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://10degres.net/assets/js/scripts.min.js"></script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61485350-1', 'auto');  
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>




	        

</body>
</html>
