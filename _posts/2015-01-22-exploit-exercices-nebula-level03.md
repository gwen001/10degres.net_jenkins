---
title: Exploit Exercices, Nebula &ndash; level03
tags:
- training
- exploit exercises
- nebula
---
> Check the home directory of flag03 and take note of the files there. 
There is a crontab that is called every couple of minutes. 
Files for this level can be found in /home/flag03.

First, let's check the home directory of our target `flag03`:

[![Exploit Exercises Nebula Level03](/images/exploit_exercices_nebula_level03_1.png)](/images/exploit_exercices_nebula_level03_1.png)

Ok we have an empty directory with full access and a shell script who looks like this:

~~~bash
#!/bin/sh
for i in /home/flag03/writable.d/* ; do
  (ulimit -t 5; bash -x "$i")
  rm -f "$i"
done
~~~

<!--more-->

It looks simple: it tries to execute each file in `writable.d` directory then delete them. 
We don't care about [ulimit](http://www.lehman.cuny.edu/cgi-bin/man-cgi?ulimit+2 "man ulimit"){:target="_blank"} here, 
it's just used to prevent cpu overloading from malicious script (each process will be killed after 5scd). 
Note that there is no check about the owner of this famous files.

So we can write a little script which will execute the `getflag` command et output the result in a text file:

~~~bash
#!/bin/sh
getflag > /tmp/output
~~~

Put it in the `writable.d` directory:

[![Exploit Exercises Nebula Level03](/images/exploit_exercices_nebula_level03_2.png)](/images/exploit_exercices_nebula_level03_2.png)

Wait a minute for the cron et voila!

[![Exploit Exercises Nebula Level03](/images/exploit_exercices_nebula_level03_3.png)](/images/exploit_exercices_nebula_level03_3.png)

Note: this his the easy way. 
Another solution would be to copy a shell somewhere with the suid bit, but Nebula seems to be patched to disallow suid shell so you have to write a program in another language like C.
